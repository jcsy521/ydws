<script src="/static/js/lockScreen.js"></script>
<script type="text/javascript">
	fn_lockScreen();
</script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/cupertino/jquery-ui.css" rel="stylesheet" type="text/css"/>
<link href="/static/css/css.css" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" href="/static/css/validationEngine.jquery.css" type="text/css" charset="utf-8" />
<script src="/static/js/jquery.dataTables.min.js"></script>
<link href="/static/css/dataTables_jui.css" rel="stylesheet" type="text/css"/>
<link href="/static/css/dataTables_highlight.css" rel="stylesheet" type="text/css"/>
<script src="/static/js/jquery.ui.datepicker-zh-CN.js"></script>
<script src="/static/js/jquery.validationEngine-en.js"></script>
<script src="/static/js/jquery.validationEngine.js"></script>
<script src="/static/js/initStyle.js"></script>
<script src="/static/js/submitForm.js"></script>
<script src="/static/js/dataTable.js"></script>
<script src="/static/js/provAndCity.js"></script>
<script src="/static/js/groupChoose.js"></script>
<script src="/static/js/dateChoose.js"></script>
<script src="/static/js/cacheQueryValues.js"></script>
{% block body %}
<fieldset class="ui-widget ui-widget-content ui-corner-all">
	<legend class="button legend ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button">
		<span class="ui-button-text">业务月报查询</span>
	</legend>
	<form id="formID" method="post" action="" onsubmit="return formSubmit2();">
		<table>
			<tr>
				<td align="right">所在城市：</td>
				<td align="left">
                    <select id="city_id" name="city_id">
						<option value="0">--全部--</option>
					{% for city in cities %}
						<option value="{{city.city_id}}">{{city.city_name}}</option>
					{% end %}
					</select>
				</td>
			</tr>
			<tr>	
				<td align="right">年份：</td>
				<td align="left">
					<select name="yeartemp" id="yeartemp">
					  {% for i in range(2010, 2030) %}
						<option value="{{i}}">{{i}}</option>
					  {% end %}
					</select>
				</td>
			</tr>
			<tr>	
				<td align="right">月份：</td>
				<td align="left">
					<select name="monthtemp" id="monthtemp">
						<option value="01">一月</option>
						<option value="02">二月</option>
						<option value="03">三月</option>
						<option value="04">四月</option>
						<option value="05">五月</option>
						<option value="06">六月</option>
						<option value="07">七月</option>
						<option value="08">八月</option>
						<option value="09">九月</option>
						<option value="10">十月</option>
						<option value="11">十一月</option>
						<option value="12">十二月</option>
					</select>
				</td>
			</tr>
			<tr>
				<td align="right" colspan="2">
					<input type="submit" value="查询" 
						onclick="fn_PushData('cities','monthly');" 
                        class="ui-button ui-widget ui-state-default ui-corner-all" 
                        role="button" aria-disabled="false" />
					<input type="hidden" id="timestamp" name="timestamp" value="" />
                </td>
			</tr>
		</table>
	</form>
</fieldset>
<div class="resultQuery">
    <div class="resultTitle"><h3>查询结果</h3></div>
    <a id="exportData" href="/download/monthly/{{hash_}}" 
       class="button download ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button">
       <span class="ui-button-text">导出Excel</span>
    </a>
</div>
<table id="reportDataTables" class="display">
    <thead>
        <tr>
            <th>序号</th><th>地市</th><th>新增集团数</th><th>集团到达数</th><th>新增用户数</th><th>用户到达数</th>
        </tr>
    </thead>
    <tbody>
        {% for result in results %}
            <tr>
				<td>{{result['id']}}</td>
				<td>{{result['city']}}</td>				<!--地市-->	
				<td>{{result['new_groups']}}</td>		<!--新增集团数-->	
				<td>{{result['total_groups']}}</td>		<!--集团到达数-->
				<td>{{result['new_targets']}}</td>		<!--用户到达数-->		
				<td>{{result['total_targets']}}</td>		<!--新增用户数-->	
            </tr>
        {% end %}
    </tbody>
	<tfoot id="tfoot">
		{% if counts %}
		<tr>
			<td colspan="2">合计：</td>
			<td>{{counts['new_groups']}}</td>	<!--新增集团数合计-->	
			<td>{{counts['total_groups']}}</td>	<!--集团到达数合计-->	
			<td>{{counts['new_targets']}}</td>	<!--新增用户数合计-->
			<td>{{counts['total_targets']}}</td>	<!--用户到达数合计-->	
		</tr>
		{% end %}
	</tfoot>
</table>
<div style="display:none">
    <input type="text" id="date_temp" value="{{interval[0] if len(interval) != 0 else 'monthly'}}" />
</div>
<script type="text/javascript">
    fn_PopData('monthly');
</script>
{% end %}
